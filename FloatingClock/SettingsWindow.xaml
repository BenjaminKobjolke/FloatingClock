<Window x:Class="FloatingClock.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Floating Clock Settings"
        Width="600"
        Height="700"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        ShowInTaskbar="True"
        Topmost="False"
        Background="#F0F0F0"
        KeyDown="SettingsWindow_KeyDown"
        Closing="Window_Closing">

    <Window.Resources>
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,15,0,10"/>
            <Setter Property="Foreground" Value="#333333"/>
        </Style>

        <Style x:Key="SettingLabel" TargetType="TextBlock">
            <Setter Property="Margin" Value="0,5,0,2"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#555555"/>
        </Style>

        <Style x:Key="SettingControl" TargetType="FrameworkElement">
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Scrollable settings content -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Padding="20">
            <StackPanel x:Name="MainSettingsPanel">

                <!-- Theme Section -->
                <TextBlock x:Name="ThemeSectionHeader" Text="Theme" Style="{StaticResource SectionHeader}"/>
                <Separator x:Name="ThemeSeparator" Margin="0,0,0,10"/>

                <TextBlock x:Name="ThemeModeLabel" Text="Application Theme:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="ThemeModeComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="ThemeMode_Changed">
                    <ComboBoxItem Content="Auto (follow system)" Tag="auto"/>
                    <ComboBoxItem Content="Light" Tag="light"/>
                    <ComboBoxItem Content="Dark" Tag="dark"/>
                </ComboBox>

                <!-- Font Section -->
                <TextBlock x:Name="FontSectionHeader" Text="Font" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Font Family:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="FontFamilyComboBox" Style="{StaticResource SettingControl}" Height="25"/>

                <!-- Window Section -->
                <TextBlock Text="Window" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Width (pixels):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="WindowWidthSlider" Minimum="100" Maximum="800" TickFrequency="10" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="WindowWidthTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Height (pixels):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="WindowHeightSlider" Minimum="50" Maximum="400" TickFrequency="10" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="WindowHeightTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Fixed Position Mode:" Style="{StaticResource SettingLabel}"/>
                <CheckBox x:Name="WindowFixedCheckBox" Content="Dock to corner (unchecked = free position)" Style="{StaticResource SettingControl}" Checked="Setting_Changed" Unchecked="Setting_Changed"/>

                <TextBlock Text="Fixed Corner:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="WindowFixedCornerComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="1 - Top Left" Tag="1"/>
                    <ComboBoxItem Content="2 - Top Right" Tag="2"/>
                    <ComboBoxItem Content="3 - Bottom Left" Tag="3"/>
                    <ComboBoxItem Content="4 - Bottom Right" Tag="4"/>
                </ComboBox>

                <TextBlock Text="Debug Mode:" Style="{StaticResource SettingLabel}"/>
                <CheckBox x:Name="WindowDebugCheckBox" Content="Show taskbar detection info on startup" Style="{StaticResource SettingControl}" Checked="Setting_Changed" Unchecked="Setting_Changed"/>

                <!-- Background Section -->
                <TextBlock Text="Background" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Background Color (ARGB hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="BackgroundColorTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="BackgroundColorPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Auto Brightness Adjustment:" Style="{StaticResource SettingLabel}"/>
                <CheckBox x:Name="BackgroundAutoBrightnessCheckBox" Content="Enable adaptive transparency" Style="{StaticResource SettingControl}" Checked="Setting_Changed" Unchecked="Setting_Changed"/>

                <TextBlock Text="Brightness Change Threshold (0-1):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="BackgroundThresholdChangeSlider" Minimum="0" Maximum="1" TickFrequency="0.01" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="BackgroundThresholdChangeTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Brightness Min Threshold (0-1):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="BackgroundThresholdMinSlider" Minimum="0" Maximum="1" TickFrequency="0.01" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="BackgroundThresholdMinTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Brightness Max Threshold (0-1):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="BackgroundThresholdMaxSlider" Minimum="0" Maximum="1" TickFrequency="0.01" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="BackgroundThresholdMaxTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Alpha Max (0-1):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="BackgroundAlphaMaxSlider" Minimum="0" Maximum="1" TickFrequency="0.01" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="BackgroundAlphaMaxTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Alpha Min (0-1):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="BackgroundAlphaMinSlider" Minimum="0" Maximum="1" TickFrequency="0.01" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="BackgroundAlphaMinTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Damping Factor (0-1):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="BackgroundDampingSlider" Minimum="0" Maximum="1" TickFrequency="0.01" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="BackgroundDampingTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <!-- Date Section -->
                <TextBlock Text="Date Display" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Show Date:" Style="{StaticResource SettingLabel}"/>
                <CheckBox x:Name="DateShowCheckBox" Content="Display date" Style="{StaticResource SettingControl}" Checked="Setting_Changed" Unchecked="Setting_Changed"/>

                <TextBlock Text="Font Size:" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="DateSizeSlider" Minimum="8" Maximum="72" TickFrequency="1" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="DateSizeTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Format (C# DateTime format):" Style="{StaticResource SettingLabel}"/>
                <TextBox x:Name="DateFormatTextBox" Style="{StaticResource SettingControl}" TextChanged="Setting_Changed"/>
                <TextBlock Text="Examples: dd/MM/yyyy, MM-dd-yyyy, dddd, MMMM d" FontSize="10" Foreground="Gray" Margin="0,-8,0,10"/>

                <TextBlock Text="Color (hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="DateColorTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="DateColorPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Vertical Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="DateVerticalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Top" Tag="Top"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Bottom" Tag="Bottom"/>
                </ComboBox>

                <TextBlock Text="Horizontal Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="DateHorizontalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Left" Tag="Left"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Right" Tag="Right"/>
                </ComboBox>

                <!-- Time Section -->
                <TextBlock Text="Time Display" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Font Size:" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="TimeSizeSlider" Minimum="8" Maximum="72" TickFrequency="1" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="TimeSizeTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Format (C# DateTime format):" Style="{StaticResource SettingLabel}"/>
                <TextBox x:Name="TimeFormatTextBox" Style="{StaticResource SettingControl}" TextChanged="Setting_Changed"/>
                <TextBlock Text="Examples: HH:mm, hh:mm tt, HH:mm:ss" FontSize="10" Foreground="Gray" Margin="0,-8,0,10"/>

                <TextBlock Text="Color (hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="TimeColorTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="TimeColorPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Vertical Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="TimeVerticalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Top" Tag="Top"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Bottom" Tag="Bottom"/>
                </ComboBox>

                <TextBlock Text="Horizontal Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="TimeHorizontalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Left" Tag="Left"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Right" Tag="Right"/>
                </ComboBox>

                <!-- Seconds Section -->
                <TextBlock Text="Seconds Display" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Show Seconds:" Style="{StaticResource SettingLabel}"/>
                <CheckBox x:Name="SecondsShowCheckBox" Content="Display seconds" Style="{StaticResource SettingControl}" Checked="Setting_Changed" Unchecked="Setting_Changed"/>

                <TextBlock Text="Font Size:" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="SecondsSizeSlider" Minimum="8" Maximum="72" TickFrequency="1" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="SecondsSizeTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Color (hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="SecondsColorTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="SecondsColorPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Vertical Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="SecondsVerticalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Top" Tag="Top"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Bottom" Tag="Bottom"/>
                </ComboBox>

                <TextBlock Text="Horizontal Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="SecondsHorizontalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Left" Tag="Left"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Right" Tag="Right"/>
                </ComboBox>

                <!-- Stack Panel Section -->
                <TextBlock Text="Layout" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Stack Panel Vertical Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="StackPanelVerticalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Top" Tag="Top"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Bottom" Tag="Bottom"/>
                </ComboBox>

                <TextBlock Text="Stack Panel Horizontal Alignment:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="StackPanelHorizontalAlignmentComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed">
                    <ComboBoxItem Content="Left" Tag="Left"/>
                    <ComboBoxItem Content="Center" Tag="Center"/>
                    <ComboBoxItem Content="Right" Tag="Right"/>
                </ComboBox>

                <!-- Command Palette Section -->
                <TextBlock Text="Command Palette" Style="{StaticResource SectionHeader}"/>
                <Separator Margin="0,0,0,10"/>

                <TextBlock Text="Background Color (ARGB hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="PaletteBackgroundColorTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="PaletteBackgroundColorPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Text Color (hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="PaletteTextColorTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="PaletteTextColorPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Selected Background Color (ARGB hex):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="PaletteSelectedBackgroundTextBox" TextChanged="ColorTextBox_Changed"/>
                    <Rectangle x:Name="PaletteSelectedBackgroundPreview" Grid.Column="1" Margin="10,0,0,0" Stroke="Gray" StrokeThickness="1"/>
                </Grid>

                <TextBlock Text="Command Palette Font Family:" Style="{StaticResource SettingLabel}"/>
                <ComboBox x:Name="PaletteFontFamilyComboBox" Style="{StaticResource SettingControl}" Height="25" SelectionChanged="Setting_Changed"/>

                <TextBlock Text="Font Size:" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="PaletteFontSizeSlider" Minimum="8" Maximum="24" TickFrequency="1" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="PaletteFontSizeTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Width (pixels):" Style="{StaticResource SettingLabel}"/>
                <Grid Style="{StaticResource SettingControl}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="PaletteWidthSlider" Minimum="200" Maximum="800" TickFrequency="10" IsSnapToTickEnabled="True" ValueChanged="Slider_ValueChanged"/>
                    <TextBox x:Name="PaletteWidthTextBox" Grid.Column="1" Margin="10,0,0,0" TextAlignment="Center" VerticalContentAlignment="Center"/>
                </Grid>

                <TextBlock Text="Show Icons:" Style="{StaticResource SettingLabel}"/>
                <CheckBox x:Name="PaletteShowIconsCheckBox" Content="Display âœ“ indicators for active commands" Style="{StaticResource SettingControl}" Checked="Setting_Changed" Unchecked="Setting_Changed"/>

                <!-- More Tools Link -->
                <TextBlock x:Name="MoreToolsTextBlock" Margin="0,15,0,0">
                    <Hyperlink x:Name="MoreToolsLink" Click="MoreToolsLink_Click">
                        <Run Text="More tools to improve your workflow"/>
                    </Hyperlink>
                </TextBlock>

                <!-- Bottom spacing -->
                <Border Height="20"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Bottom buttons -->
        <Border Grid.Row="1" Background="White" BorderBrush="#CCCCCC" BorderThickness="0,1,0,0" Padding="20,15">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="SaveButton" Content="Save &amp; Restart" Width="120" Height="30" Margin="0,0,10,0" Click="SaveButton_Click" ToolTip="Save settings and restart (Ctrl+S)"/>
                <Button x:Name="CancelButton" Content="Cancel" Width="100" Height="30" Click="CancelButton_Click"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
